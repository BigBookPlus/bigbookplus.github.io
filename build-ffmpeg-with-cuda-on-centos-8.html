<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="generator" content="Pelican" />
        <title>"Build FFMpeg with CUDA on CentOS 8"</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
        <meta name="description" content="FFMepeg CUDA CentOS 8 Prepareing CUDA toolkits need to be installed. Then the following listed packages should be installed too. dnf -y install..." />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">BigBook's Tech Blog</a></h1>
                <nav><ul>
                    <li class="active"><a href="/category/misc.html">misc</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/build-ffmpeg-with-cuda-on-centos-8.html" rel="bookmark"
           title="Permalink to "Build FFMpeg with CUDA on CentOS 8"">"Build FFMpeg with CUDA on CentOS 8"</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2022-07-04T00:00:00+02:00">
                Published: Mon 04 July 2022
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/bigbook.html">"BigBook"</a>
        </address>
<p>In <a href="/category/misc.html">misc</a>.</p>

</footer><!-- /.post-info -->      <ul>
<li>FFMepeg</li>
<li>CUDA</li>
<li>CentOS 8</li>
</ul>
<hr>
<h2>Prepareing</h2>
<p>CUDA toolkits need to be installed. 
Then the following listed packages should be installed too.</p>
<div class="highlight"><pre><span></span><code>dnf<span class="w"> </span>-y<span class="w"> </span>install<span class="w">   </span>automake<span class="w"> </span>autoconf<span class="w"> </span>libtool<span class="w"> </span>make<span class="w"> </span>gcc<span class="w"> </span>gcc-c++
dnf<span class="w"> </span>--enablerepo<span class="o">=</span>powertools<span class="w"> </span>-y<span class="w"> </span>install<span class="w"> </span>giflib-devel
dnf<span class="w"> </span>--enablerepo<span class="o">=</span>powertools<span class="w"> </span>-y<span class="w"> </span>install<span class="w"> </span>libexif-devel
dnf<span class="w"> </span>-y<span class="w"> </span>install<span class="w"> </span>bison<span class="w"> </span>pkgconfig<span class="w"> </span>glib2-devel<span class="w"> </span>gettext<span class="w"> </span>make<span class="w"> </span>libpng-devel<span class="w"> </span>libjpeg-devel<span class="w"> </span>libtiff-devel<span class="w"> </span>libexif-devel<span class="w"> </span>giflib-devel<span class="w"> </span>libX11-devel<span class="w"> </span>freetype-devel<span class="w"> </span>fontconfig-devel<span class="w">  </span>cairo-devel<span class="w"> </span>fribidi-devel
dnf<span class="w"> </span>-y<span class="w"> </span>install<span class="w"> </span>openssl<span class="w"> </span>openssl-devel
</code></pre></div>

<p>Note that, <code>powertools</code> might be <code>PowerTools</code> according to different configurations, just replace the name.</p>
<p>To enable the powertools channel, run the following command</p>
<div class="highlight"><pre><span></span><code>yum<span class="w"> </span>install<span class="w"> </span>dnf-plugins-core
yum<span class="w"> </span>config-manager<span class="w"> </span>--set-enabled<span class="w"> </span>powertools
</code></pre></div>

<h2>yasm</h2>
<div class="highlight"><pre><span></span><code><span class="w">   </span><span class="nb">cd</span><span class="w"> </span>/tmp
<span class="w">   </span>wget<span class="w"> </span>http://www.tortall.net/projects/yasm/releases/yasm-1.3.0.tar.gz
<span class="w">   </span>tar<span class="w"> </span>zxvf<span class="w"> </span>yasm-1.3.0.tar.gz
<span class="w">   </span><span class="nb">cd</span><span class="w">  </span>yasm-1.3.0
<span class="w">   </span>./configure<span class="w"> </span>
<span class="w">   </span>make<span class="w"> </span>
<span class="w">   </span>make<span class="w"> </span>install
</code></pre></div>

<h2>nasm</h2>
<div class="highlight"><pre><span></span><code><span class="w">  </span><span class="nb">cd</span><span class="w"> </span>/tmp
<span class="w">  </span>wget<span class="w"> </span>https://www.nasm.us/pub/nasm/releasebuilds/2.15/nasm-2.15.tar.gz
<span class="w">  </span>tar<span class="w"> </span>xvf<span class="w"> </span>nasm-2.15.tar.gz
<span class="w">  </span><span class="nb">cd</span><span class="w"> </span>nasm-2.15
<span class="w">  </span>./configure<span class="w"> </span>
<span class="w">  </span>make<span class="w"> </span>
<span class="w">  </span>make<span class="w"> </span>install
</code></pre></div>

<h2>libx264</h2>
<div class="highlight"><pre><span></span><code><span class="w">   </span><span class="nb">cd</span><span class="w"> </span>/tmp
<span class="w">   </span>yum<span class="w"> </span>install<span class="w"> </span>git<span class="w"> </span><span class="o">(</span>可选<span class="o">)</span>
<span class="w">   </span>git<span class="w"> </span>clone<span class="w"> </span>https://code.videolan.org/videolan/x264.git
<span class="w">   </span><span class="nb">cd</span><span class="w"> </span>x264
<span class="w">   </span>./configure<span class="w">  </span>--enable-shared
<span class="w">   </span>make<span class="w"> </span>
<span class="w">   </span>make<span class="w"> </span>install
</code></pre></div>

<h2>libmp3lame</h2>
<div class="highlight"><pre><span></span><code><span class="w">   </span><span class="nb">cd</span><span class="w"> </span>/tmp
<span class="w">   </span>wget<span class="w"> </span>https://sourceforge.net/projects/lame/files/lame/3.100/lame-3.100.tar.gz
<span class="w">   </span>tar<span class="w"> </span>zxvf<span class="w"> </span>lame-3.100.tar.gz
<span class="w">   </span><span class="nb">cd</span><span class="w"> </span>lame-3.100
<span class="w">   </span>./configure<span class="w"> </span>--enable-shared
<span class="w">   </span>make<span class="w"> </span>
<span class="w">   </span>make<span class="w"> </span>install
</code></pre></div>

<h2>libgdiplus</h2>
<div class="highlight"><pre><span></span><code><span class="w">  </span><span class="nb">cd</span><span class="w"> </span>/tmp
<span class="w">  </span>wget<span class="w"> </span>http://download.mono-project.com/sources/libgdiplus/libgdiplus0-6.0.5.tar.gz
<span class="w">  </span>tar<span class="w"> </span>zxvf<span class="w"> </span>libgdiplus0-6.0.5.tar.gz
<span class="w">  </span><span class="nb">cd</span><span class="w"> </span>libgdiplus-6.0.5
<span class="w">  </span>./configure
<span class="w">  </span>make<span class="w"> </span>
<span class="w">  </span>make<span class="w"> </span>install
</code></pre></div>

<h2>ffnvcodec</h2>
<div class="highlight"><pre><span></span><code><span class="w">    </span><span class="nb">cd</span><span class="w"> </span>/tmp
<span class="w">    </span>git<span class="w"> </span>clone<span class="w"> </span>https://git.videolan.org/git/ffmpeg/nv-codec-headers.git
<span class="w">    </span><span class="nb">cd</span><span class="w"> </span>nv-codec-headers<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>sudo<span class="w"> </span>make<span class="w"> </span>install<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">cd</span><span class="w"> </span>–
</code></pre></div>

<p>or</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>dnf<span class="w"> </span>-y<span class="w"> </span>install<span class="w"> </span>nv-codec-headers
</code></pre></div>

<h2>refresh &amp;&amp; update</h2>
<div class="highlight"><pre><span></span><code><span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;/usr/local/lib&quot;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>/etc/ld.so.conf
<span class="w">  </span>ldconfig
</code></pre></div>

<h2>FFMpeg with CUDA</h2>
<div class="highlight"><pre><span></span><code>git<span class="w"> </span>clone<span class="w"> </span>https://git.ffmpeg.org/ffmpeg.git<span class="w"> </span>ffmpeg/
./configure<span class="w"> </span>--enable-cuda-nvcc<span class="w"> </span>--enable-cuda<span class="w"> </span>--enable-cuvid<span class="w"> </span>--enable-nvdec<span class="w"> </span>--enable-nvenc<span class="w"> </span>--enable-nonfree<span class="w"> </span>--enable-libnpp<span class="w"> </span>--disable-static<span class="w"> </span>--enable-shared<span class="w"> </span>--extra-cflags<span class="o">=</span>-I/usr/local/cuda/include<span class="w"> </span>--extra-ldflags<span class="o">=</span>-L/usr/local/cuda/lib64
make<span class="w"> </span>-j8
sudo<span class="w"> </span>make<span class="w"> </span>install
</code></pre></div>

<h2>test</h2>
<div class="highlight"><pre><span></span><code>ffmepg
</code></pre></div>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="https://getpelican.com/">Pelican</a></li>
                            <li><a href="https://www.python.org/">Python.org</a></li>
                            <li><a href="https://palletsprojects.com/p/jinja/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="https://getpelican.com/">Pelican</a>, which takes great advantage of <a href="https://www.python.org/">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="https://www.smashingmagazine.com/2009/08/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>
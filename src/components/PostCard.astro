---
import type { CollectionEntry } from 'astro:content';

interface Props {
  entry: CollectionEntry<'posts'>;
  lang: 'zh' | 'en';
  variant?: 'featured' | 'normal';
}

const { entry, lang, variant = 'normal' } = Astro.props;
const year = entry.data.date.getFullYear();
const url = `/${lang}/${year}/${entry.data.slug}/`;
const featured = variant === 'featured';
---

<article class={featured ? "grid gap-6 md:grid-cols-2 rounded-xl border border-gray-200 dark:border-gray-800 overflow-hidden" : "rounded-xl border border-gray-200 dark:border-gray-800 p-5 hover:shadow-lg transition-shadow"}>
  {entry.data.cover ? (
    <a href={url} class={featured ? "" : "block"}>
      <img
        src={entry.data.cover}
        alt={entry.data.title}
        class={featured ? "h-64 w-full object-cover md:h-full" : "mb-4 h-48 w-full rounded-lg object-cover"}
        loading="lazy"
      />
    </a>
  ) : null}

  <div class={featured ? "flex flex-col justify-center p-8" : ""}>
    <p class="text-xs uppercase tracking-wide opacity-70">
      {entry.data.lang.toUpperCase()} Â· {entry.data.date.toISOString().slice(0, 10)}
    </p>
    <h3 class={featured ? "mt-3 text-3xl font-bold leading-tight" : "mt-2 text-lg font-semibold leading-snug"}>
      <a href={url} class="hover:text-blue-600 dark:hover:text-blue-400 transition-colors">
        {entry.data.title}
      </a>
    </h3>
    {entry.data.description ? (
      <p class="mt-3 opacity-80 line-clamp-3">{entry.data.description}</p>
    ) : null}
    {entry.data.tags?.length ? (
      <div class="mt-4 flex flex-wrap gap-2">
        {entry.data.tags.slice(0, featured ? 5 : 3).map((tag) => (
          <a
            href={`/${lang}/tags/${tag}/`}
            class="rounded-full bg-gray-100 dark:bg-gray-800 px-3 py-1 text-xs hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors"
          >
            {tag}
          </a>
        ))}
      </div>
    ) : null}
  </div>
</article>

<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="generator" content="Pelican" />
        <title>"Curved Text Detection by PaddleOCR"</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
        <meta name="description" content="Deep Learning Inference OCR Curved Text Detection PaddleOCR Text Detection Task is an old topic of Detction tasks. Curved text is much more free..." />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">BigBook's Tech Blog</a></h1>
                <nav><ul>
                    <li class="active"><a href="/category/misc.html">misc</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/curved-text-detection-by-paddleocr.html" rel="bookmark"
           title="Permalink to "Curved Text Detection by PaddleOCR"">"Curved Text Detection by PaddleOCR"</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2022-04-14T00:00:00+02:00">
                Published: Thu 14 April 2022
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/bigbook.html">"BigBook"</a>
        </address>
<p>In <a href="/category/misc.html">misc</a>.</p>

</footer><!-- /.post-info -->      <ul>
<li>Deep Learning Inference</li>
<li>OCR</li>
<li>Curved Text Detection</li>
<li>PaddleOCR</li>
</ul>
<hr>
<p><img alt="Detection Result" src="/img/in-post/curved_text_paddleocr/det_res_img623.jpg"></p>
<p>Text Detection Task is an old topic of Detction tasks. Curved text is much more free form. in this Post, we show you how to run the curved text detection by PaddleOCR.</p>
<h2>Setup Environment</h2>
<p>Create a virtual environment named paddle_env.</p>
<div class="highlight"><pre><span></span><code>conda<span class="w"> </span>create<span class="w"> </span>--name<span class="w"> </span>paddle_env<span class="w"> </span><span class="nv">python</span><span class="o">=</span><span class="m">3</span>.8
</code></pre></div>

<p>Then activate it.</p>
<div class="highlight"><pre><span></span><code>conda<span class="w"> </span>activate<span class="w"> </span>paddle_env<span class="w"> </span>
</code></pre></div>

<p>Install paddlepaddle and paddle ocr packages through pip.</p>
<div class="highlight"><pre><span></span><code>python<span class="w"> </span>-m<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>paddlepaddle
pip<span class="w"> </span>install<span class="w"> </span><span class="s2">&quot;paddleocr&gt;=2.0.1&quot;</span><span class="w"> </span><span class="c1"># Recommend to use version 2.0.1+</span>
</code></pre></div>

<h2>Test Environment</h2>
<p>Test the installations.</p>
<div class="highlight"><pre><span></span><code>wget<span class="w"> </span>https://paddleocr.bj.bcebos.com/dygraph_v2.1/ppocr_img.zip
unzip<span class="w"> </span>ppocr_img.zip
paddleocr<span class="w"> </span>--image_dir<span class="w"> </span>./ppocr_img/imgs_en/img_12.jpg<span class="w"> </span><span class="se">\</span>
<span class="w">        </span>--use_angle_cls<span class="w"> </span><span class="nb">true</span><span class="w"> </span>--lang<span class="w"> </span>en<span class="w"> </span>--use_gpu<span class="w"> </span><span class="nb">false</span>
</code></pre></div>

<h2>Curved Text Detection with SAST</h2>
<p>Clone PaddleOCR repo from github. Checkout the dynamic graph branch.</p>
<div class="highlight"><pre><span></span><code>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/PaddlePaddle/PaddleOCR.git
<span class="nb">cd</span><span class="w"> </span>PaddleOCR
git<span class="w"> </span>checkout<span class="w"> </span>dygraph
</code></pre></div>

<p>Download the training model of SAST.</p>
<div class="highlight"><pre><span></span><code>mkdir<span class="w"> </span>models
<span class="nb">cd</span><span class="w"> </span>models
wget<span class="w"> </span>https://paddleocr.bj.bcebos.com/dygraph_v2.0/en/det_r50_vd_sast_totaltext_v2.0_train.tar
tar<span class="w"> </span>-xvf<span class="w"> </span>det_r50_vd_sast_totaltext_v2.0_train.tar
<span class="nb">cd</span><span class="w"> </span>-<span class="w"> </span><span class="c1">#return to PaddleOCR repo path</span>
</code></pre></div>

<p>The training model of SAST need to be converted into inference model.</p>
<div class="highlight"><pre><span></span><code>python<span class="w"> </span>tools/export_model.py<span class="w"> </span>-c<span class="w"> </span>configs/det/det_r50_vd_sast_totaltext.yml<span class="w"> </span><span class="se">\</span>
<span class="w">        </span>-o<span class="w"> </span>Global.pretrained_model<span class="o">=</span>./models/det_r50_vd_sast_totaltext_v2.0_train/best_accuracy<span class="w"> </span><span class="se">\</span>
<span class="w">        </span>Global.save_inference_dir<span class="o">=</span>./inference/det_sast_tt
</code></pre></div>

<p>After convertion succeed, a new folder named inference will be created. </p>
<p>Now we are good to run the curved text detction.</p>
<div class="highlight"><pre><span></span><code>python<span class="w"> </span>tools/infer/predict_det.py<span class="w"> </span>--det_algorithm<span class="o">=</span><span class="s2">&quot;SAST&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">        </span>--image_dir<span class="o">=</span><span class="s2">&quot;./doc/imgs_en/img623.jpg&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">        </span>--det_model_dir<span class="o">=</span><span class="s2">&quot;./inference/det_sast_tt/&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">        </span>--det_sast_polygon<span class="o">=</span>True
</code></pre></div>

<p><img alt="Detection Result" src="/img/in-post/curved_text_paddleocr/det_res_img623.jpg"></p>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="https://getpelican.com/">Pelican</a></li>
                            <li><a href="https://www.python.org/">Python.org</a></li>
                            <li><a href="https://palletsprojects.com/p/jinja/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="https://getpelican.com/">Pelican</a>, which takes great advantage of <a href="https://www.python.org/">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="https://www.smashingmagazine.com/2009/08/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>